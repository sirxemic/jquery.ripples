/*!
 * jQuery Ripples plugin v0.5.4 / https://github.com/sirxemic/jquery.ripples
 * MIT License
 * @author sirxemic / https://sirxemic.com/
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function d(a){return"%"==a[a.length-1]}function e(){function e(a,b){var d="OES_texture_"+a,e=d+"_linear",f=e in c,g=[d];return f&&g.push(e),{type:b,linearSupport:f,extensions:g}}var a=document.createElement("canvas");if(b=a.getContext("webgl")||a.getContext("experimental-webgl"),!b)return null;var c={};if(["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear"].forEach(function(a){var d=b.getExtension(a);d&&(c[a]=d)}),!c.OES_texture_float)return null;var d=[];d.push(e("float",b.FLOAT)),c.OES_texture_half_float&&d.push(e("half_float",c.OES_texture_half_float.HALF_FLOAT_OES));var f=b.createTexture(),g=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,g),b.bindTexture(b.TEXTURE_2D,f),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);for(var h=null,i=0;i<d.length;i++)if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,32,32,0,b.RGBA,d[i].type,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,f,0),b.checkFramebufferStatus(b.FRAMEBUFFER)===b.FRAMEBUFFER_COMPLETE){h=d[i];break}return h}function f(a,b){try{return new ImageData(a,b)}catch(d){var c=document.createElement("canvas");return c.getContext("2d").createImageData(a,b)}}function g(a){var b=a.split(" ");if(1!==b.length)return b.map(function(b){switch(a){case"center":return"50%";case"top":case"left":return"0";case"right":case"bottom":return"100%";default:return b}});switch(a){case"center":return["50%","50%"];case"top":return["50%","0"];case"bottom":return["50%","100%"];case"left":return["0","50%"];case"right":return["100%","50%"];default:return[a,"50%"]}}function h(a,c,d){function e(a,c){var d=b.createShader(a);if(b.shaderSource(d,c),b.compileShader(d),!b.getShaderParameter(d,b.COMPILE_STATUS))throw new Error("compile error: "+b.getShaderInfoLog(d));return d}var f={};if(f.id=b.createProgram(),b.attachShader(f.id,e(b.VERTEX_SHADER,a)),b.attachShader(f.id,e(b.FRAGMENT_SHADER,c)),b.linkProgram(f.id),!b.getProgramParameter(f.id,b.LINK_STATUS))throw new Error("link error: "+b.getProgramInfoLog(f.id));f.uniforms={},f.locations={},b.useProgram(f.id),b.enableVertexAttribArray(0);for(var g,h,i=/uniform (\w+) (\w+)/g,j=a+c;null!=(g=i.exec(j));)h=g[2],f.locations[h]=b.getUniformLocation(f.id,h);return f}function i(a,c){b.activeTexture(b.TEXTURE0+(c||0)),b.bindTexture(b.TEXTURE_2D,a)}function j(a){var b=/url\(["']?([^"']*)["']?\)/.exec(a);return null==b?null:b[1]}function k(a){return a.match(/^data:/)}var b,c=a(window),l=e(),m=f(32,32);a("head").prepend("<style>.jquery-ripples { position: relative; z-index: 0; }</style>");var n=function(c,d){function j(){e.step(),requestAnimationFrame(j)}var e=this;this.$el=a(c),this.interactive=d.interactive,this.resolution=d.resolution,this.textureDelta=new Float32Array([1/this.resolution,1/this.resolution]),this.perturbance=d.perturbance,this.dropRadius=d.dropRadius,this.crossOrigin=d.crossOrigin,this.imageUrl=d.imageUrl,this.cacheBuster=d.cacheBuster;var f=document.createElement("canvas");f.width=this.$el.innerWidth(),f.height=this.$el.innerHeight(),this.canvas=f,this.$canvas=a(f),this.$canvas.css({position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:-1}),this.$el.addClass("jquery-ripples").append(f),this.context=b=f.getContext("webgl")||f.getContext("experimental-webgl"),l.extensions.forEach(function(a){b.getExtension(a)}),a(window).on("resize",function(){var a=e.$el.innerWidth(),b=e.$el.innerHeight();a==e.canvas.width&&b==e.canvas.height||(f.width=a,f.height=b)}),this.textures=[],this.framebuffers=[],this.bufferWriteIndex=0,this.bufferReadIndex=1;for(var g=0;g<2;g++){var h=b.createTexture(),i=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,i),i.width=this.resolution,i.height=this.resolution,b.bindTexture(b.TEXTURE_2D,h),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,l.linearSupport?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,l.linearSupport?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.resolution,this.resolution,0,b.RGBA,l.type,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,h,0),this.textures.push(h),this.framebuffers.push(i)}this.quad=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this.quad),b.bufferData(b.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),b.STATIC_DRAW),this.initShaders(),this.initTexture(),this.setTransparentTexture(),this.loadImage(),b.clearColor(0,0,0,0),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),this.visible=!0,this.running=!0,this.inited=!0,this.setupPointerEvents(),requestAnimationFrame(j)};n.DEFAULTS={imageUrl:null,resolution:256,dropRadius:20,perturbance:.03,interactive:!0,crossOrigin:"",cacheBuster:!1},n.prototype={setupPointerEvents:function(){function b(){return a.visible&&a.running&&a.interactive}function c(c,d){b()&&a.dropAtPointer(c,a.dropRadius*(d?1.5:1),d?.14:.01)}var a=this;this.$el.on("mousemove.ripples",function(a){c(a)}).on("touchmove.ripples, touchstart.ripples",function(a){for(var b=a.originalEvent.changedTouches,d=0;d<b.length;d++)c(b[d])}).on("mousedown.ripples",function(a){c(a,!0)})},loadImage:function(){var a=this;b=this.context;var c=this.imageUrl||j(this.originalCssBackgroundImage)||j(this.$el.css("backgroundImage"));if(c!=this.imageSource){if(this.imageSource=c,!this.imageSource)return void this.setTransparentTexture();var d=new Image;d.onload=function(){function c(a){return 0==(a&a-1)}b=a.context;var e=c(d.width)&&c(d.height)?b.REPEAT:b.CLAMP_TO_EDGE;b.bindTexture(b.TEXTURE_2D,a.backgroundTexture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,e),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,d),a.backgroundWidth=d.width,a.backgroundHeight=d.height,a.hideCssBackground()},d.onerror=function(){b=a.context,a.setTransparentTexture()};var e=this.imageSource;k(this.imageSource)||(d.crossOrigin=this.crossOrigin,this.cacheBuster&&(e=e+"?cb="+Math.floor(1e7*Math.random()))),d.src=e}},step:function(){b=this.context,this.visible&&(this.computeTextureBoundaries(),this.running&&this.update(),this.render())},drawQuad:function(){b.bindBuffer(b.ARRAY_BUFFER,this.quad),b.vertexAttribPointer(0,2,b.FLOAT,!1,0,0),b.drawArrays(b.TRIANGLE_FAN,0,4)},render:function(){b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,this.canvas.width,this.canvas.height),b.enable(b.BLEND),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),b.useProgram(this.renderProgram.id),i(this.backgroundTexture,0),i(this.textures[0],1),b.uniform1f(this.renderProgram.locations.perturbance,this.perturbance),b.uniform2fv(this.renderProgram.locations.topLeft,this.renderProgram.uniforms.topLeft),b.uniform2fv(this.renderProgram.locations.bottomRight,this.renderProgram.uniforms.bottomRight),b.uniform2fv(this.renderProgram.locations.containerRatio,this.renderProgram.uniforms.containerRatio),b.uniform1i(this.renderProgram.locations.samplerBackground,0),b.uniform1i(this.renderProgram.locations.samplerRipples,1),this.drawQuad(),b.disable(b.BLEND)},update:function(){b.viewport(0,0,this.resolution,this.resolution),b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffers[this.bufferWriteIndex]),i(this.textures[this.bufferReadIndex]),b.useProgram(this.updateProgram.id),this.drawQuad(),this.swapBufferIndices()},swapBufferIndices:function(){this.bufferWriteIndex=1-this.bufferWriteIndex,this.bufferReadIndex=1-this.bufferReadIndex},computeTextureBoundaries:function(){var f,a=this.$el.css("background-size"),b=this.$el.css("background-attachment"),e=g(this.$el.css("background-position"));if("fixed"==b?(f={left:window.pageXOffset,top:window.pageYOffset},f.width=c.width(),f.height=c.height()):(f=this.$el.offset(),f.width=this.$el.innerWidth(),f.height=this.$el.innerHeight()),"cover"==a)var h=Math.max(f.width/this.backgroundWidth,f.height/this.backgroundHeight),i=this.backgroundWidth*h,j=this.backgroundHeight*h;else if("contain"==a)var h=Math.min(f.width/this.backgroundWidth,f.height/this.backgroundHeight),i=this.backgroundWidth*h,j=this.backgroundHeight*h;else{a=a.split(" ");var i=a[0]||"",j=a[1]||i;d(i)?i=f.width*parseFloat(i)/100:"auto"!=i&&(i=parseFloat(i)),d(j)?j=f.height*parseFloat(j)/100:"auto"!=j&&(j=parseFloat(j)),"auto"==i&&"auto"==j?(i=this.backgroundWidth,j=this.backgroundHeight):("auto"==i&&(i=this.backgroundWidth*(j/this.backgroundHeight)),"auto"==j&&(j=this.backgroundHeight*(i/this.backgroundWidth)))}var k=e[0],l=e[1];k=d(k)?f.left+(f.width-i)*parseFloat(k)/100:f.left+parseFloat(k),l=d(l)?f.top+(f.height-j)*parseFloat(l)/100:f.top+parseFloat(l);var m=this.$el.offset();this.renderProgram.uniforms.topLeft=new Float32Array([(m.left-k)/i,(m.top-l)/j]),this.renderProgram.uniforms.bottomRight=new Float32Array([this.renderProgram.uniforms.topLeft[0]+this.$el.innerWidth()/i,this.renderProgram.uniforms.topLeft[1]+this.$el.innerHeight()/j]);var n=Math.max(this.canvas.width,this.canvas.height);this.renderProgram.uniforms.containerRatio=new Float32Array([this.canvas.width/n,this.canvas.height/n])},initShaders:function(){var a=["attribute vec2 vertex;","varying vec2 coord;","void main() {","coord = vertex * 0.5 + 0.5;","gl_Position = vec4(vertex, 0.0, 1.0);","}"].join("\n");this.dropProgram=h(a,["precision highp float;","const float PI = 3.141592653589793;","uniform sampler2D texture;","uniform vec2 center;","uniform float radius;","uniform float strength;","varying vec2 coord;","void main() {","vec4 info = texture2D(texture, coord);","float drop = max(0.0, 1.0 - length(center * 0.5 + 0.5 - coord) / radius);","drop = 0.5 - cos(drop * PI) * 0.5;","info.r += drop * strength;","gl_FragColor = info;","}"].join("\n")),this.updateProgram=h(a,["precision highp float;","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 coord;","void main() {","vec4 info = texture2D(texture, coord);","vec2 dx = vec2(delta.x, 0.0);","vec2 dy = vec2(0.0, delta.y);","float average = (","texture2D(texture, coord - dx).r +","texture2D(texture, coord - dy).r +","texture2D(texture, coord + dx).r +","texture2D(texture, coord + dy).r",") * 0.25;","info.g += (average - info.r) * 2.0;","info.g *= 0.995;","info.r += info.g;","gl_FragColor = info;","}"].join("\n")),b.uniform2fv(this.updateProgram.locations.delta,this.textureDelta),this.renderProgram=h(["precision highp float;","attribute vec2 vertex;","uniform vec2 topLeft;","uniform vec2 bottomRight;","uniform vec2 containerRatio;","varying vec2 ripplesCoord;","varying vec2 backgroundCoord;","void main() {","backgroundCoord = mix(topLeft, bottomRight, vertex * 0.5 + 0.5);","backgroundCoord.y = 1.0 - backgroundCoord.y;","ripplesCoord = vec2(vertex.x, -vertex.y) * containerRatio * 0.5 + 0.5;","gl_Position = vec4(vertex.x, -vertex.y, 0.0, 1.0);","}"].join("\n"),["precision highp float;","uniform sampler2D samplerBackground;","uniform sampler2D samplerRipples;","uniform vec2 delta;","uniform float perturbance;","varying vec2 ripplesCoord;","varying vec2 backgroundCoord;","void main() {","float height = texture2D(samplerRipples, ripplesCoord).r;","float heightX = texture2D(samplerRipples, vec2(ripplesCoord.x + delta.x, ripplesCoord.y)).r;","float heightY = texture2D(samplerRipples, vec2(ripplesCoord.x, ripplesCoord.y + delta.y)).r;","vec3 dx = vec3(delta.x, heightX - height, 0.0);","vec3 dy = vec3(0.0, heightY - height, delta.y);","vec2 offset = -normalize(cross(dy, dx)).xz;","float specular = pow(max(0.0, dot(offset, normalize(vec2(-0.6, 1.0)))), 4.0);","gl_FragColor = texture2D(samplerBackground, backgroundCoord + offset * perturbance) + specular;","}"].join("\n")),b.uniform2fv(this.renderProgram.locations.delta,this.textureDelta)},initTexture:function(){this.backgroundTexture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.backgroundTexture),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,1),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR)},setTransparentTexture:function(){b.bindTexture(b.TEXTURE_2D,this.backgroundTexture),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,m)},hideCssBackground:function(){var a=this.$el[0].style.backgroundImage;"none"!=a&&(this.originalInlineCss=a,this.originalCssBackgroundImage=this.$el.css("backgroundImage"),this.$el.css("backgroundImage","none"))},restoreCssBackground:function(){this.$el.css("backgroundImage",this.originalInlineCss||"")},dropAtPointer:function(a,b,c){var d=parseInt(this.$el.css("border-left-width"))||0,e=parseInt(this.$el.css("border-top-width"))||0;this.drop(a.pageX-this.$el.offset().left-d,a.pageY-this.$el.offset().top-e,b,c)},drop:function(a,c,d,e){b=this.context;var f=this.$el.innerWidth(),g=this.$el.innerHeight(),h=Math.max(f,g);d/=h;var j=new Float32Array([(2*a-f)/h,(g-2*c)/h]);b.viewport(0,0,this.resolution,this.resolution),b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffers[this.bufferWriteIndex]),i(this.textures[this.bufferReadIndex]),b.useProgram(this.dropProgram.id),b.uniform2fv(this.dropProgram.locations.center,j),b.uniform1f(this.dropProgram.locations.radius,d),b.uniform1f(this.dropProgram.locations.strength,e),this.drawQuad(),this.swapBufferIndices()},destroy:function(){this.$el.off(".ripples").removeClass("jquery-ripples").removeData("ripples"),this.$canvas.remove(),this.restoreCssBackground()},show:function(){this.visible=!0,this.$canvas.show(),this.hideCssBackground()},hide:function(){this.visible=!1,this.$canvas.hide(),this.restoreCssBackground()},pause:function(){this.running=!1},play:function(){this.running=!0},set:function(a,b){switch(a){case"dropRadius":case"perturbance":case"interactive":case"crossOrigin":this[a]=b;break;case"imageUrl":this.imageUrl=b,this.loadImage();break;case"cacheBuster":this[a]=b}}};var o=a.fn.ripples;a.fn.ripples=function(b){if(!l)throw new Error("Your browser does not support WebGL, the OES_texture_float extension or rendering to floating point textures.");var c=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var d=a(this),e=d.data("ripples"),f=a.extend({},n.DEFAULTS,d.data(),"object"==typeof b&&b);(e||"string"!=typeof b)&&(e?"string"==typeof b&&n.prototype[b].apply(e,c):d.data("ripples",e=new n(this,f)))})},a.fn.ripples.Constructor=n,a.fn.ripples.noConflict=function(){return a.fn.ripples=o,this}});